{
  "info": {
    "_postman_id": "83fba3bf-6745-4cb0-b9d5-0be5bb2cd408",
    "name": "Duo Admin Panel",
    "schema": "https://schema.getpostman.com/json/collection/v2.0.0/collection.json"
  },
  "item": [
    {
      "name": "Find Duo Admin Panel Devices",
      "event": [
        {
          "listen": "test",
          "script": {
            "id": "afb4903d-2380-429b-be61-8007d47ae877",
            "exec": [
              "const devices = pm.response.json();",
              "const deviceUids = [];",
              "devices.forEach((device) => {",
              "    deviceUids.push(device.uid);",
              "});",
              "pm.environment.set(\"deviceUids\", deviceUids);"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "id": "9d2da1ef-e678-44f3-ab99-28e780149814",
      "protocolProfileBehavior": {
        "disableBodyPruning": true
      },
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Content-Type",
            "type": "text",
            "value": "application/json"
          }
        ],
        "url": {
          "raw": "{{aegisBaseUrl}}/targets/devices?q=deviceType:DUO_ADMIN_PANEL",
          "host": [
            "{{aegisBaseUrl}}"
          ],
          "path": [
            "targets",
            "devices"
          ],
          "query": [
            {
              "key": "q",
              "value": "deviceType:DUO_ADMIN_PANEL",
              "description": "Query Parameter"
            }
          ]
        },
        "description": "Set the `devicesQuery` variable to execute a custom query"
      },
      "response": []
    },
    {
      "name": "Get Duo Admin Panel Applications",
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "id": "37cc4d9a-8f83-4d5a-88bd-213a67cd8c27",
            "exec": [
              "const deviceUids = pm.environment.get(\"deviceUids\") || [];",
              "const queryParam = deviceUids.map(deviceUid => `deviceUid:${deviceUid}`).join(\"+OR+\");",
              "console.log(`Query params: ${queryParam}`);",
              "pm.request.url.query.add(`q=${queryParam}`);"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "id": "4f3e4b46-47db-4ee4-a483-fe2d592de94d",
      "protocolProfileBehavior": {
        "disableBodyPruning": true
      },
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{aegisBaseUrl}}/duo/applications?q=deviceUid:f360ae10-fe7d-4c4d-88c4-d4df7b67dda6&agg=count",
          "host": [
            "{{aegisBaseUrl}}"
          ],
          "path": [
            "duo",
            "applications"
          ],
          "query": [
            {
              "key": "q",
              "value": "deviceUid:f360ae10-fe7d-4c4d-88c4-d4df7b67dda6"
            },
            {
              "key": "agg",
              "value": "count"
            }
          ]
        }
      },
      "response": []
    }
  ],
  "auth": {
    "type": "bearer",
    "bearer": {
      "token": "{{apiToken}}"
    }
  },
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "id": "546699ea-180e-408e-ad14-15fcc38f754d",
        "type": "text/javascript",
        "exec": [
          ""
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "id": "6ad02fc5-3b87-4e45-968f-32e71ec26bda",
        "type": "text/javascript",
        "exec": [
          ""
        ]
      }
    }
  ]
}